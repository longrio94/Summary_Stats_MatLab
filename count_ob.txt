SELECT
    EXTRACT(YEAR FROM peil_dt) AS year,
    EXTRACT(MONTH FROM peil_dt) AS month,
    COUNT(*) AS total_records,
    SUM(CASE WHEN default_ind = 'Y' THEN 1 ELSE 0 END) AS default_count,
    (SUM(CASE WHEN default_ind = 'Y' THEN 1 ELSE 0 END) * 100.0) / COUNT(*) AS default_rate_percentage
FROM
    rds_obligor
GROUP BY
    EXTRACT(YEAR FROM peil_dt),
    EXTRACT(MONTH FROM peil_dt)
ORDER BY
    year,
    month;
