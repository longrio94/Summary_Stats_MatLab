SELECT
    peil_dt,
    facility_id,
    COUNT(DISTINCT agreement_id) AS agreement_count
FROM
    your_table_name
GROUP BY
    peil_dt,
    facility_id
HAVING
    COUNT(DISTINCT agreement_id) > 1
ORDER BY
    peil_dt,
    facility_id;
