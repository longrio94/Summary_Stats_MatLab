SELECT
    t1.peil_dt,
    COUNT(*) AS matching_accounts,
    AVG(t1.balance - t2.balance) AS average_balance_difference,
    SUM(t1.balance - t2.balance) AS total_balance_difference,
    MAX(t1.balance - t2.balance) AS max_balance_difference,
    MIN(t1.balance - t2.balance) AS min_balance_difference
FROM
    table1 t1
INNER JOIN
    table2 t2
    ON t1.account_id = t2.account_id
    AND t1.peil_dt = t2.peil_dt
GROUP BY
    t1.peil_dt
ORDER BY
    t1.peil_dt;
